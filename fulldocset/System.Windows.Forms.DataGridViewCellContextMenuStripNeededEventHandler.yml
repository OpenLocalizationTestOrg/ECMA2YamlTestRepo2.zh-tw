### YamlMime:ManagedReference
items:
- uid: System.Windows.Forms.DataGridViewCellContextMenuStripNeededEventHandler
  id: DataGridViewCellContextMenuStripNeededEventHandler
  langs:
  - csharp
  name: DataGridViewCellContextMenuStripNeededEventHandler
  nameWithType: DataGridViewCellContextMenuStripNeededEventHandler
  fullName: System.Windows.Forms.DataGridViewCellContextMenuStripNeededEventHandler
  type: Delegate
  summary: "代表將處理的方法<xref href=&quot;System.Windows.Forms.DataGridView.CellContextMenuStripNeeded&quot;></xref>事件<xref href=&quot;System.Windows.Forms.DataGridView&quot;> </xref>。"
  remarks: "<xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded>只發生事件時<xref:System.Windows.Forms.DataGridView>控制項<xref:System.Windows.Forms.DataGridView.DataSource%2A>屬性設定或其<xref:System.Windows.Forms.DataGridView.VirtualMode%2A>屬性是`true`。</xref:System.Windows.Forms.DataGridView.VirtualMode%2A> </xref:System.Windows.Forms.DataGridView.DataSource%2A> </xref:System.Windows.Forms.DataGridView> </xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded>       當您處理<xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded>您指定的處理常式中的捷徑功能表會顯示事件，每當使用者按一下滑鼠右鍵在資料格。</xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> 當您想要顯示目前的狀態或儲存格的值所決定的捷徑功能表，這非常有用。       <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded>事件也會發生值<xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A?displayProperty=fullName>擷取屬性，或是以程式設計的方式，或當使用者按一下滑鼠右鍵資料格。</xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A?displayProperty=fullName> </xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded>       您可以使用<xref:System.Windows.Forms.DataGridViewCellEventArgs.ColumnIndex%2A>和<xref:System.Windows.Forms.DataGridViewCellEventArgs.RowIndex%2A>屬性來判斷狀態或儲存格值，並使用這項資訊來設定<xref:System.Windows.Forms.DataGridViewCellContextMenuStripNeededEventArgs.ContextMenuStrip%2A>屬性。</xref:System.Windows.Forms.DataGridViewCellContextMenuStripNeededEventArgs.ContextMenuStrip%2A> </xref:System.Windows.Forms.DataGridViewCellEventArgs.RowIndex%2A> </xref:System.Windows.Forms.DataGridViewCellEventArgs.ColumnIndex%2A> 這個屬性會初始化儲存格的值與<xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A>屬性，事件就會覆寫。</xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A>       處理<xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded>事件時使用大量的資料，以避免效能的負面影響的設定儲存格<xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A>多個資料格的值。</xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A> </xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> 如需詳細資訊，請參閱[縮放 Windows Form DataGridView 控制項的最佳作法](~/add/includes/ajax-current-ext-md.md)。       您也可以指定快顯功能表，針對個別資料列，而不是個別儲存格的資料列設定<xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A>屬性或處理<xref:System.Windows.Forms.DataGridView>控制項的<xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded>事件。</xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded> </xref:System.Windows.Forms.DataGridView> </xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A> 資料格<xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A>屬性設定會覆寫的資料列<xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A>屬性設定值，而<xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded>事件覆寫兩者<xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded>事件和資料列<xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A>屬性設定。</xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A> </xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded> </xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> </xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A> </xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A> 您可以指定`null`對於儲存格捷徑功能表，不過，若要避免覆寫的資料列的捷徑功能表。       如需處理事件的詳細資訊，請參閱[NIB︰ 使用事件](http://msdn.microsoft.com/en-us/01e4f1bc-e55e-413f-98c7-6588493e5f67)。       當您建立 DataGridViewCellContextMenuStripNeededEventHandler 委派時，您可以識別即將處理此事件的方法。 若要將事件與您的事件處理常式產生關聯，將委派的執行個體加入此事件。 除非您移除委派，否則每當事件發生時，會呼叫事件處理常式。 如需事件處理常式委派的詳細資訊，請參閱[NIB︰ 事件和委派](http://msdn.microsoft.com/en-us/d98fd58b-fa4f-4598-8378-addf4355a115)。"
  example:
  - "The following code example uses <xref:System.Windows.Forms.DataGridViewCellContextMenuStripNeededEventArgs> to set the context menu without unsharing the row.  \n  \n [!code-cs[System.Windows.Forms.DataGridView_SharedRowScenarios#20](~/add/codesnippet/csharp/t-system.windows.forms.d_39_1.cs)]\n [!code-cpp[System.Windows.Forms.DataGridView_SharedRowScenarios#20](~/add/codesnippet/cpp/t-system.windows.forms.d_39_1.cpp)]\n [!code-vb[System.Windows.Forms.DataGridView_SharedRowScenarios#20](~/add/codesnippet/visualbasic/t-system.windows.forms.d_39_1.vb)]"
  syntax:
    content: public delegate void DataGridViewCellContextMenuStripNeededEventHandler(object sender, DataGridViewCellContextMenuStripNeededEventArgs e);
  inheritance:
  - System.Delegate
  platform:
  - net462
references:
- uid: System.Delegate
  isExternal: false
  name: System.Delegate
