### YamlMime:ManagedReference
items:
- uid: System.Data.Sql.SqlDataSourceEnumerator
  id: SqlDataSourceEnumerator
  children:
  - System.Data.Sql.SqlDataSourceEnumerator.GetDataSources
  - System.Data.Sql.SqlDataSourceEnumerator.Instance
  langs:
  - csharp
  name: SqlDataSourceEnumerator
  nameWithType: SqlDataSourceEnumerator
  fullName: System.Data.Sql.SqlDataSourceEnumerator
  type: Class
  summary: "提供列舉的本機網路中的 SQL Server 的所有可用執行個體的機制。"
  remarks: "SQL Server 2000 和 SQL Server 2005 可讓應用程式，以判斷目前的網路中的 SQL Server 執行個體存在。 SqlDataSourceEnumerator 類別公開給應用程式開發人員，提供此資訊<xref:System.Data.DataTable>包含所有可用伺服器的相關資訊。</xref:System.Data.DataTable> 傳回這個資料表包含清單的使用者嘗試建立新的連接，提供符合清單的伺服器執行個體和`Connection Properties`對話方塊中，展開下拉式清單包含所有可用的伺服器。"
  syntax:
    content: 'public sealed class SqlDataSourceEnumerator : System.Data.Common.DbDataSourceEnumerator'
  inheritance:
  - System.Object
  - System.Data.Common.DbDataSourceEnumerator
  implements: []
  inheritedMembers: []
  platform:
  - net462
- uid: System.Data.Sql.SqlDataSourceEnumerator.GetDataSources
  id: GetDataSources
  parent: System.Data.Sql.SqlDataSourceEnumerator
  langs:
  - csharp
  name: GetDataSources()
  nameWithType: SqlDataSourceEnumerator.GetDataSources()
  fullName: System.Data.Sql.SqlDataSourceEnumerator.GetDataSources()
  type: Method
  assemblies:
  - System.Data
  namespace: System.Data.Sql
  summary: "擷取<xref href=&quot;System.Data.DataTable&quot;></xref>包含所有可見 SQL Server 2000 或 SQL Server 2005 執行個體的相關資訊。"
  remarks: "這個方法所傳回的資料表包含下列資料行，其中包含字串: |資料行 |描述 |  |------------|-----------------|  |**ServerName**|伺服器的名稱。 |  |**InstanceName**|伺服器執行個體名稱。 如果伺服器正在執行的預設執行個體為空白。 |  |**IsClustered**|指出伺服器是否為叢集的一部分。 |  |**Version**|(SQL Server 2000 為 8.00) 9.00.SQL Server 2005 的伺服器版本。 |     > [!NOTE] > 由於所使用的機制的本質<xref:System.Data.Sql.SqlDataSourceEnumerator>找出在網路上的資料來源，方法不一定會傳回可用的伺服器的完整清單，清單可能不會在每次呼叫相同。</xref:System.Data.Sql.SqlDataSourceEnumerator> 如果您打算使用此函數可讓使用者從清單中選取伺服器，請確定您一律也提供選項，以防伺服器列舉型別不會傳回所有可用的伺服器名稱不在清單中，輸入。 此外，這個方法可能需要花費大量時間來執行，所以要小心有關呼叫它時效能很重要。"
  example:
  - "The following console application retrieves information about all the visible SQL Server instances and displays the information in the console window.  \n  \n```vb#  \nImports System.Data.Sql  \n  \nModule Module1  \n  Sub Main()  \n    ' Retrieve the enumerator instance and then the data.  \n    Dim instance As SqlDataSourceEnumerator = _  \n     SqlDataSourceEnumerator.Instance  \n    Dim table As System.Data.DataTable = instance.GetDataSources()  \n  \n    ' Display the contents of the table.  \n    DisplayData(table)  \n  \n    Console.WriteLine(\"Press any key to continue.\")  \n    Console.ReadKey()  \n  End Sub  \n  \n  Private Sub DisplayData(ByVal table As DataTable)  \n    For Each row As DataRow In table.Rows  \n      For Each col As DataColumn In table.Columns  \n        Console.WriteLine(\"{0} = {1}\", col.ColumnName, row(col))  \n      Next  \n      Console.WriteLine(\"============================\")  \n    Next  \n  End Sub  \nEnd Module  \n```  \n  \n```c#  \nusing System.Data.Sql;  \n  \nclass Program  \n{  \n  static void Main()  \n  {  \n    // Retrieve the enumerator instance and then the data.  \n    SqlDataSourceEnumerator instance =  \n      SqlDataSourceEnumerator.Instance;  \n    System.Data.DataTable table = instance.GetDataSources();  \n  \n    // Display the contents of the table.  \n    DisplayData(table);  \n  \n    Console.WriteLine(\"Press any key to continue.\");  \n    Console.ReadKey();  \n  }  \n  \n  private static void DisplayData(System.Data.DataTable table)  \n  {  \n    foreach (System.Data.DataRow row in table.Rows)  \n    {  \n      foreach (System.Data.DataColumn col in table.Columns)  \n      {  \n        Console.WriteLine(\"{0} = {1}\", col.ColumnName, row[col]);  \n      }  \n      Console.WriteLine(\"============================\");  \n    }  \n  }  \n}  \n```"
  syntax:
    content: public override System.Data.DataTable GetDataSources ();
    parameters: []
    return:
      type: System.Data.DataTable
      description: "傳回<xref href=&quot;System.Data.DataTable&quot;></xref>包含可見的 SQL Server 執行個體的相關資訊。"
  overload: System.Data.Sql.SqlDataSourceEnumerator.GetDataSources*
  exceptions: []
  platform:
  - net462
- uid: System.Data.Sql.SqlDataSourceEnumerator.Instance
  id: Instance
  parent: System.Data.Sql.SqlDataSourceEnumerator
  langs:
  - csharp
  name: Instance
  nameWithType: SqlDataSourceEnumerator.Instance
  fullName: System.Data.Sql.SqlDataSourceEnumerator.Instance
  type: Property
  assemblies:
  - System.Data
  namespace: System.Data.Sql
  summary: "取得執行個體<xref href=&quot;System.Data.Sql.SqlDataSourceEnumerator&quot;> </xref>，這可以用來擷取可用的 SQL Server 執行個體的相關資訊。"
  remarks: "<xref:System.Data.Sql.SqlDataSourceEnumerator>類別並未提供一個建構函式。</xref:System.Data.Sql.SqlDataSourceEnumerator> 您可以使用執行個體屬性改為擷取類別的執行個體。"
  example:
  - "The following console application displays a list of all the available SQL Server 2005 instances within the local network. This code uses the <xref:System.Data.DataTable.Select%2A> method to filter the rows in the table returned by the <xref:System.Data.Sql.SqlDataSourceEnumerator.GetDataSources%2A> method.  \n  \n```vb#  \nImports System.Data.Sql  \n  \nModule Module1  \n  Sub Main()  \n    ' Retrieve the enumerator instance, and  \n    ' then retrieve the data sources.  \n    Dim instance As SqlDataSourceEnumerator = _  \n     SqlDataSourceEnumerator.Instance  \n    Dim table As System.Data.DataTable = instance.GetDataSources()  \n  \n    ' Filter the sources to just show SQL Server 2005 instances.  \n    Dim rows() As DataRow = table.Select(\"Version LIKE '9%'\")  \n    For Each row As DataRow In rows  \n      Console.WriteLine(row(\"ServerName\"))  \n    Next  \n    Console.WriteLine(\"Press any key to continue.\")  \n    Console.ReadKey()  \n  End Sub  \nEnd Module  \n```  \n  \n```c#  \nusing System.Data.Sql;  \n  \nclass Program  \n{  \n  static void Main()  \n  {  \n    // Retrieve the enumerator instance, and  \n    // then retrieve the data sources.  \n    SqlDataSourceEnumerator instance =  \n      SqlDataSourceEnumerator.Instance;  \n    System.Data.DataTable table = instance.GetDataSources();  \n  \n    // Filter the sources to just show SQL Server 2005 instances.  \n    System.Data.DataRow[] rows = table.Select(\"Version LIKE '9%'\");  \n    foreach (System.Data.DataRow row in rows)  \n    {  \n      Console.WriteLine(row[\"ServerName\"]);  \n    }  \n    Console.WriteLine(\"Press any key to continue.\");  \n    Console.ReadKey();  \n  }  \n}  \n```"
  syntax:
    content: public static System.Data.Sql.SqlDataSourceEnumerator Instance { get; }
    return:
      type: System.Data.Sql.SqlDataSourceEnumerator
      description: "執行個體<xref href=&quot;System.Data.Sql.SqlDataSourceEnumerator&quot;></xref>用來擷取可用的 SQL Server 執行個體的相關資訊。"
  overload: System.Data.Sql.SqlDataSourceEnumerator.Instance*
  exceptions: []
  platform:
  - net462
references:
- uid: System.Data.Common.DbDataSourceEnumerator
  isExternal: false
  name: System.Data.Common.DbDataSourceEnumerator
- uid: System.Data.Sql.SqlDataSourceEnumerator.GetDataSources
  parent: System.Data.Sql.SqlDataSourceEnumerator
  isExternal: false
  name: GetDataSources()
  nameWithType: SqlDataSourceEnumerator.GetDataSources()
  fullName: System.Data.Sql.SqlDataSourceEnumerator.GetDataSources()
- uid: System.Data.DataTable
  parent: System.Data
  isExternal: false
  name: DataTable
  nameWithType: DataTable
  fullName: System.Data.DataTable
- uid: System.Data.Sql.SqlDataSourceEnumerator.Instance
  parent: System.Data.Sql.SqlDataSourceEnumerator
  isExternal: false
  name: Instance
  nameWithType: SqlDataSourceEnumerator.Instance
  fullName: System.Data.Sql.SqlDataSourceEnumerator.Instance
- uid: System.Data.Sql.SqlDataSourceEnumerator
  parent: System.Data.Sql
  isExternal: false
  name: SqlDataSourceEnumerator
  nameWithType: SqlDataSourceEnumerator
  fullName: System.Data.Sql.SqlDataSourceEnumerator
- uid: System.Data.Sql.SqlDataSourceEnumerator.GetDataSources*
  parent: System.Data.Sql.SqlDataSourceEnumerator
  isExternal: false
  name: GetDataSources
  nameWithType: SqlDataSourceEnumerator.GetDataSources
- uid: System.Data.Sql.SqlDataSourceEnumerator.Instance*
  parent: System.Data.Sql.SqlDataSourceEnumerator
  isExternal: false
  name: Instance
  nameWithType: SqlDataSourceEnumerator.Instance
