### YamlMime:ManagedReference
items:
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  id: SqlPersonalizationProvider
  children:
  - System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.#ctor
  - System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName
  - System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.FindState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.Web.UI.WebControls.WebParts.PersonalizationStateQuery,System.Int32,System.Int32,System.Int32@)
  - System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.GetCountOfState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.Web.UI.WebControls.WebParts.PersonalizationStateQuery)
  - System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.Initialize(System.String,System.Collections.Specialized.NameValueCollection)
  - System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.LoadPersonalizationBlobs(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String,System.Byte[]@,System.Byte[]@)
  - System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetPersonalizationBlob(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String)
  - System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.String[],System.String[])
  - System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetUserState(System.String,System.DateTime)
  - System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.SavePersonalizationBlob(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String,System.Byte[])
  langs:
  - csharp
  name: SqlPersonalizationProvider
  nameWithType: SqlPersonalizationProvider
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  type: Class
  summary: "實作會使用 Microsoft SQL Server 的個人化提供者。"
  remarks: "這個類別會定義使用 Microsoft SQL Server 的個人化提供者所需的功能。 個人化提供者同時載入和儲存個人化資料代表<xref:System.Web.UI.WebControls.WebParts.WebPartPersonalization>執行個體。</xref:System.Web.UI.WebControls.WebParts.WebPartPersonalization> 這個類別實作的邏輯讀取和寫入到執行 SQL Server 的電腦，而且也會實作<xref:System.Web.UI.WebControls.WebParts.PersonalizationProvider>.</xref:System.Web.UI.WebControls.WebParts.PersonalizationProvider>中定義的所有抽象方法 如需個人化提供者的詳細資訊，請參閱<xref:System.Web.UI.WebControls.WebParts.PersonalizationProvider>.</xref:System.Web.UI.WebControls.WebParts.PersonalizationProvider>       搭配 SQL Server 中使用 Web 組件個人化的資料設計依賴兩個常見 SQL 資料庫資料表的存在和其支援預存程序，大多數 SQL 為基礎的特徵案例所共用。 這些資料表和檢視已安裝和解除安裝使用下列指令碼:-installpagepersonalization.sql – 安裝個人化資料表、 檢視和相關的預存程序。      -uninstallpagepersonalization.sql-解除安裝個人化資料表、 檢視和相關的預存程序。       請務必注意，如果您的 Web 應用程式不會在執行預設信任層級無法個人化<xref:System.Web.AspNetHostingPermissionLevel>或更高版本 (您可以設定自訂的信任層級，在 Web.config 檔案使用`<trust level=&quot;&quot; />`項目)。</xref:System.Web.AspNetHostingPermissionLevel> <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration>SqlPersonalizationProvider 類別會檢查信任層級和<xref:System.Web.AspNetHostingPermissionLevel>初始化的時間。</xref:System.Web.AspNetHostingPermissionLevel> </xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration> 如果您設定您的應用程式執行的信任層級<xref:System.Web.AspNetHostingPermissionLevel>，和您的應用程式第一次嘗試存取個人化資料的應用程式管理的個人化資料的情況下，您在使用預設 SqlPersonalizationProvider 提供者，它會失敗，因為 ASP.NET 背景工作處理序中執行<xref:System.Web.AspNetHostingPermissionLevel>信任並沒有呼叫各種類別中的必要權限<xref:System.Data.SqlClient>命名空間。</xref:System.Data.SqlClient> </xref:System.Web.AspNetHostingPermissionLevel> </xref:System.Web.AspNetHostingPermissionLevel>"
  syntax:
    content: 'public class SqlPersonalizationProvider : System.Web.UI.WebControls.WebParts.PersonalizationProvider'
  inheritance:
  - System.Object
  - System.Configuration.Provider.ProviderBase
  - System.Web.UI.WebControls.WebParts.PersonalizationProvider
  implements: []
  inheritedMembers:
  - System.Configuration.Provider.ProviderBase.Description
  - System.Configuration.Provider.ProviderBase.Name
  - System.Web.UI.WebControls.WebParts.PersonalizationProvider.CreateSupportedUserCapabilities
  - System.Web.UI.WebControls.WebParts.PersonalizationProvider.DetermineInitialScope(System.Web.UI.WebControls.WebParts.WebPartManager,System.Web.UI.WebControls.WebParts.PersonalizationState)
  - System.Web.UI.WebControls.WebParts.PersonalizationProvider.DetermineUserCapabilities(System.Web.UI.WebControls.WebParts.WebPartManager)
  - System.Web.UI.WebControls.WebParts.PersonalizationProvider.LoadPersonalizationState(System.Web.UI.WebControls.WebParts.WebPartManager,System.Boolean)
  - System.Web.UI.WebControls.WebParts.PersonalizationProvider.ResetPersonalizationState(System.Web.UI.WebControls.WebParts.WebPartManager)
  - System.Web.UI.WebControls.WebParts.PersonalizationProvider.SavePersonalizationState(System.Web.UI.WebControls.WebParts.PersonalizationState)
  platform:
  - net462
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.#ctor
  id: '#ctor'
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  langs:
  - csharp
  name: SqlPersonalizationProvider()
  nameWithType: SqlPersonalizationProvider.SqlPersonalizationProvider()
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.SqlPersonalizationProvider()
  type: Constructor
  assemblies:
  - System.Web
  namespace: System.Web.UI.WebControls.WebParts
  summary: "初始化的新執行個體<xref href=&quot;System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider&quot;></xref>類別。"
  remarks: "SqlPersonalizationProvider 建構函式由 ASP.NET 呼叫來建立的執行個體<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>類別做為應用程式的組態中指定。</xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider> 這個建構函式不是從您的程式碼使用。"
  syntax:
    content: public SqlPersonalizationProvider ();
    parameters: []
  overload: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.#ctor*
  exceptions: []
  platform:
  - net462
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName
  id: ApplicationName
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  langs:
  - csharp
  name: ApplicationName
  nameWithType: SqlPersonalizationProvider.ApplicationName
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName
  type: Property
  assemblies:
  - System.Web
  namespace: System.Web.UI.WebControls.WebParts
  summary: "取得或設定要儲存和擷取個人化資訊的應用程式的名稱。"
  remarks: "ApplicationName 屬性供<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>群組使用者資訊的類別。</xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider> 來限定應用程式名稱的使用者資訊，您可以在單一資料庫中儲存多個應用程式的資訊而不重複的使用者名稱之間發生衝突。 此外，多個 ASP.NET 應用程式可以使用相同的使用者資料庫中 ApplicationName 屬性指定相同的值。 ApplicationName 屬性可以透過程式設計的方式，設定或它可以是以宣告方式設定 Web 應用程式使用的組態檔中`applicationName`屬性`<providers>`> 一節。       如果未指定值`applicationName`Web 應用程式組態檔中的屬性則<xref:System.Web.Hosting.HostingEnvironment.ApplicationVirtualPath%2A>使用應用程式所做的第一個要求的屬性值。</xref:System.Web.Hosting.HostingEnvironment.ApplicationVirtualPath%2A>      > [!CAUTION] > 所服務的所有要求所都使用的單一預設個人化提供者執行個體是因為<xref:System.Web.HttpApplication>物件，您可以有多個要求同時執行，而且嘗試設定 ApplicationName 屬性值。</xref:System.Web.HttpApplication> ApplicationName 屬性不是安全執行緒的多個寫入，並變更 ApplicationName 屬性值，可能會導致非預期的行為，應用程式的多個使用者。 建議您避免讓使用者能夠設定 ApplicationName 屬性，除非所需的程式碼。 ApplicationName 屬性設定，可能需要的應用程式的範例是管理多個應用程式的個人化資料的系統管理應用程式。 這類應用程式應該在單一使用者應用程式並不是 Web 應用程式。"
  syntax:
    content: public override string ApplicationName { get; set; }
    return:
      type: System.String
      description: "要儲存和擷取個人化資訊的應用程式名稱。 預設值是<> *> 目前屬性值<> *>。"
  overload: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName*
  exceptions:
  - type: System.Configuration.Provider.ProviderException
    commentId: T:System.Configuration.Provider.ProviderException
    description: "屬性已設定為字串的長度超過 256 個字元。"
  platform:
  - net462
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.FindState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.Web.UI.WebControls.WebParts.PersonalizationStateQuery,System.Int32,System.Int32,System.Int32@)
  id: FindState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.Web.UI.WebControls.WebParts.PersonalizationStateQuery,System.Int32,System.Int32,System.Int32@)
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  langs:
  - csharp
  name: FindState(PersonalizationScope,PersonalizationStateQuery,Int32,Int32,Int32)
  nameWithType: SqlPersonalizationProvider.FindState(PersonalizationScope,PersonalizationStateQuery,Int32,Int32,Int32)
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.FindState(PersonalizationScope,PersonalizationStateQuery,Int32,Int32,Int32)
  type: Method
  assemblies:
  - System.Web
  namespace: System.Web.UI.WebControls.WebParts
  summary: "傳回集合，其中包含零或多個<xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationStateInfo&quot;> </xref>-衍生根據指定的範圍和參數的物件。"
  remarks: "傳回的項目組由限制`pageSize`和`pageIndex`參數，其中`pageSize`會控制要傳回的記錄數目和`pageIndex`控制哪一筆記錄傳回。 比方說，`pageIndex`為 0 和`pageSize`25 個會傳回前 25 個相符項目，雖然`pageIndex`的 1 和`pageSize`25 個會傳回出現 26-50。 如果您想要擷取所有可用的記錄，設定`pageIndex`為 0，和`pageSize`至<xref:System.Int32.MaxValue>。</xref:System.Int32.MaxValue>       <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo>-衍生的物件會傳回依字母順序排列的順序排序<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo.Path%2A>和<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.Username%2A>，兩者以遞增順序。</xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.Username%2A> </xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo.Path%2A> </xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo>       這個方法會將查詢萬用字元的字元傳遞至基礎資料存放區。 目前取決於每個提供者處理等星號 （*）、 百分比符號 （%） 或底線 (_) 字元的方式支援萬用字元。       一般來說，對於 SQL 標準的資料存放區，您可以執行萬用字元搜尋部分的路徑上以出現在開頭、 結尾或中間的搜尋字串文字中的萬用字元<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>屬性。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> 例如，若要尋找開頭為&quot;~/approot&quot;，所有路徑<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>屬性會設定為&quot;~/approot%&quot;。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>       同樣地，萬用字元搜尋部分的使用者名稱可能會出現在任何時間點的文字字串中的萬用字元<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>屬性。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A> 例如，若要尋找所有啟動的使用者名稱與&quot;John&quot;，<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>參數會看起來像&quot;John %&quot;。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>       下列查詢條件約束套用:-如果只有`scope`提供，和`query`是`null`或上的所有屬性`query`傳回`null`或預設值，則比對所指定的所有記錄`scope`傳回參數。      -如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>屬性不是`null`，傳回的記錄也會篩選根據的路徑符合<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>屬性值。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> </xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>      -如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>屬性不是`null`，傳回的記錄也會篩選根據的使用者名稱符合<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>屬性值。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A> </xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>      -如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>屬性不等於<xref:System.DateTime.MaxValue>，則傳回的記錄也會篩選傳回非作用中使用者相關聯的記錄。</xref:System.DateTime.MaxValue> </xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> 比較包含記錄其中<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>屬性小於或等於<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>屬性。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> </xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>       請注意，這個方法不會驗證查詢參數的組合。 例如，程式碼可以要求一組共用的範圍中的特定使用者名稱與相關聯的個人化狀態記錄。 因為使用者名稱不是共用的資訊與相關聯，則傳回的集合會是空白。       有可能會傳回空集合的參數組合包括:- <xref:System.Web.UI.WebControls.WebParts.PersonalizationScope> <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>.</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>結合的範圍</xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>      -<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>範圍中的任何或所有的值組合<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>， <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>，和<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>屬性。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> </xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A> </xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> </xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>"
  syntax:
    content: public override System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope, System.Web.UI.WebControls.WebParts.PersonalizationStateQuery query, int pageIndex, int pageSize, out int totalRecords);
    parameters:
    - id: scope
      type: System.Web.UI.WebControls.WebParts.PersonalizationScope
      description: "A <xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationScope&quot;> </xref>指出要查詢的個人化資訊。 這個值不能<xref uid=&quot;langword_csharp_null&quot; name=&quot;null&quot; href=&quot;&quot;> </xref>。"
    - id: query
      type: System.Web.UI.WebControls.WebParts.PersonalizationStateQuery
      description: "A <xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationStateQuery&quot;> </xref>包含查詢。 這個值可以是<xref uid=&quot;langword_csharp_null&quot; name=&quot;null&quot; href=&quot;&quot;> </xref>。"
    - id: pageIndex
      type: System.Int32
      description: "查詢開始的位置。"
    - id: pageSize
      type: System.Int32
      description: "要傳回的記錄數目。"
    - id: totalRecords
      type: System.Int32
      description: "可用的記錄總數。"
    return:
      type: System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection
      description: "A <xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection&quot;> </xref>包含零或多個<xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationStateInfo&quot;> </xref>-衍生物件。"
  overload: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.FindState*
  exceptions:
  - type: System.ArgumentException
    commentId: T:System.ArgumentException
    description: "<code>pageIndex</code> is less than zero.  \n  \n \\- or -  \n  \n <code>pageSize</code> is less than or equal to zero.  \n  \n \\- or -  \n  \n The combination of <code>pageIndex</code> and <code>pageSize</code> results in a value greater than <xref:System.Int32.MaxValue>.  \n  \n \\- or -  \n  \n <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch*> is non-<xref uid=\"langword_csharp_null\" name=\"null\" href=\"\"></xref> and is an empty string (\"\") after trimming.  \n  \n \\- or -  \n  \n The length of <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch*> is greater than 256 characters when the value is non-<xref uid=\"langword_csharp_null\" name=\"null\" href=\"\"></xref>.  \n  \n \\- or -  \n  \n <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch*> is non-<xref uid=\"langword_csharp_null\" name=\"null\" href=\"\"></xref> and is an empty string after trimming.  \n  \n \\- or -  \n  \n The length of <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch*> is greater than 256 characters when the value is non-<xref uid=\"langword_csharp_null\" name=\"null\" href=\"\"></xref>."
  - type: System.ArgumentOutOfRangeException
    commentId: T:System.ArgumentOutOfRangeException
    description: "<code>  scope </code>指定不是有效的值從<xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationScope&quot;></xref>列舉型別。"
  platform:
  - net462
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.GetCountOfState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.Web.UI.WebControls.WebParts.PersonalizationStateQuery)
  id: GetCountOfState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.Web.UI.WebControls.WebParts.PersonalizationStateQuery)
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  langs:
  - csharp
  name: GetCountOfState(PersonalizationScope,PersonalizationStateQuery)
  nameWithType: SqlPersonalizationProvider.GetCountOfState(PersonalizationScope,PersonalizationStateQuery)
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.GetCountOfState(PersonalizationScope,PersonalizationStateQuery)
  type: Method
  assemblies:
  - System.Web
  namespace: System.Web.UI.WebControls.WebParts
  summary: "傳回指定存在於基礎資料存放區中的資料列數目的計數<code> scope </code>參數。"
  remarks: "這個方法會將查詢萬用字元的字元傳遞至基礎資料存放區。 目前取決於每個提供者處理等星號 （*）、 百分比符號 （%） 或底線 (_) 字元的方式支援萬用字元。       一般來說，對於 SQL 標準的資料存放區，您可以執行萬用字元搜尋部分的路徑上以出現在開頭、 結尾或中間的搜尋字串文字中的萬用字元<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>屬性。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> 例如，若要尋找開頭為&quot;~/approot&quot;，所有路徑<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>屬性會設定為&quot;~/approot%&quot;。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>       同樣地，萬用字元搜尋部分的使用者名稱可能會出現在任何時間點的文字字串中的萬用字元<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>屬性。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A> 例如，若要尋找所有啟動的使用者名稱與&quot;John&quot;，<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>參數會看起來像&quot;John %&quot;。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>       下列查詢條件約束套用:-如果只有`scope`提供，和`query`是`null`或上的所有屬性`query`傳回`null`或預設值，則比對所指定的所有記錄`scope`傳回參數。      -如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>屬性不是`null`，傳回的記錄也會篩選根據的路徑符合<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>屬性值。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> </xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>      -如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>不`null`，傳回的記錄也會篩選根據的使用者名稱符合<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>屬性值。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A> </xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>      -如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>屬性不等於<xref:System.DateTime.MaxValue>，則傳回的記錄也會篩選傳回非作用中使用者相關聯的記錄。</xref:System.DateTime.MaxValue> </xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> 比較包含記錄其中<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>屬性小於或等於<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>屬性。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> </xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>       請注意，這個方法不會驗證查詢參數的組合。 例如，程式碼可以要求在共用範圍的非作用中使用者相關聯的狀態記錄的計數。 沒有非作用中的自訂的概念，因為傳回的計數會是零。       有可能會傳回空集合的參數組合包括:- <xref:System.Web.UI.WebControls.WebParts.PersonalizationScope> <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>.</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>結合的範圍</xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>      -<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>範圍中的任何或所有的值組合<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>， <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>，和<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>屬性。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A> </xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A> </xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A> </xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>"
  syntax:
    content: public override int GetCountOfState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope, System.Web.UI.WebControls.WebParts.PersonalizationStateQuery query);
    parameters:
    - id: scope
      type: System.Web.UI.WebControls.WebParts.PersonalizationScope
      description: "A <xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationScope&quot;> </xref>指出要查詢的個人化資訊。 這個值不能<xref uid=&quot;langword_csharp_null&quot; name=&quot;null&quot; href=&quot;&quot;> </xref>。"
    - id: query
      type: System.Web.UI.WebControls.WebParts.PersonalizationStateQuery
      description: "A <xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationStateQuery&quot;> </xref>包含查詢。 這個值可以是<xref uid=&quot;langword_csharp_null&quot; name=&quot;null&quot; href=&quot;&quot;> </xref>。"
    return:
      type: System.Int32
      description: "在基礎資料存放區中存在指定的資料列數目<code> scope </code>參數。"
  overload: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.GetCountOfState*
  exceptions:
  - type: System.ArgumentException
    commentId: T:System.ArgumentException
    description: "<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch*> is non-<xref uid=\"langword_csharp_null\" name=\"null\" href=\"\"></xref> and is an empty string (\"\") after trimming.  \n  \n \\- or -  \n  \n The length of <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch*> is greater than 256 characters when the value is non-<xref uid=\"langword_csharp_null\" name=\"null\" href=\"\"></xref>.  \n  \n \\- or -  \n  \n <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch*> is non-<xref uid=\"langword_csharp_null\" name=\"null\" href=\"\"></xref> and is an empty string after trimming.  \n  \n \\- or -  \n  \n The length of <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch*> is greater than 256 characters when the value is non-<xref uid=\"langword_csharp_null\" name=\"null\" href=\"\"></xref>."
  - type: System.ArgumentOutOfRangeException
    commentId: T:System.ArgumentOutOfRangeException
    description: "<code>  scope </code>指定不是有效的值從<xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationScope&quot;></xref>列舉型別。"
  platform:
  - net462
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.Initialize(System.String,System.Collections.Specialized.NameValueCollection)
  id: Initialize(System.String,System.Collections.Specialized.NameValueCollection)
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  langs:
  - csharp
  name: Initialize(String,NameValueCollection)
  nameWithType: SqlPersonalizationProvider.Initialize(String,NameValueCollection)
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.Initialize(String,NameValueCollection)
  type: Method
  assemblies:
  - System.Web
  namespace: System.Web.UI.WebControls.WebParts
  summary: "實作所需的 Microsoft SQL Server 的個人化提供者的初始化程序。 這個方法不是直接從您的程式碼使用。"
  remarks: "這個方法與 SQL 資料庫使用個人化提供的初始化程序，並不是直接從您的程式碼使用。"
  syntax:
    content: public override void Initialize (string name, System.Collections.Specialized.NameValueCollection configSettings);
    parameters:
    - id: name
      type: System.String
      description: "應用程式名稱，因為它會出現在組態檔。"
    - id: configSettings
      type: System.Collections.Specialized.NameValueCollection
      description: "應用程式的組態設定。"
  overload: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.Initialize*
  exceptions:
  - type: System.Configuration.Provider.ProviderException
    commentId: T:System.Configuration.Provider.ProviderException
    description: "No connection string is configured for the provider.  \n  \n \\- or -  \n  \n The connection string for the provider cannot be found.  \n  \n \\- or -  \n  \n There are additional attributes on the provider's <xref uid=\"langword_csharp_&lt;add&gt;\" name=\"&lt;add&gt;\" href=\"\"></xref> element beyond those described in the configuration settings.  \n  \n \\- or -  \n  \n The length of the application name is greater than 256 characters.  \n  \n \\- or -  \n  \n The application domain hosting the application is running at a trust level below <xref href=\"System.Web.AspNetHostingPermissionLevel\"></xref> trust."
  - type: System.ArgumentNullException
    commentId: T:System.ArgumentNullException
    description: "<code>configSettings</code>is <xref uid=&quot;langword_csharp_null&quot; name=&quot;null&quot; href=&quot;&quot;></xref>."
  platform:
  - net462
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.LoadPersonalizationBlobs(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String,System.Byte[]@,System.Byte[]@)
  id: LoadPersonalizationBlobs(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String,System.Byte[]@,System.Byte[]@)
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  langs:
  - csharp
  name: LoadPersonalizationBlobs(WebPartManager,String,String,Byte[],Byte[])
  nameWithType: SqlPersonalizationProvider.LoadPersonalizationBlobs(WebPartManager,String,String,Byte[],Byte[])
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.LoadPersonalizationBlobs(WebPartManager,String,String,Byte[],Byte[])
  type: Method
  assemblies:
  - System.Web
  namespace: System.Web.UI.WebControls.WebParts
  summary: "從基礎資料存放區，根據指定的參數載入個人化資料。"
  remarks: "這個方法會使用`webPartManager`， `path`，和`username`參數做為擷取索引鍵。 傳回的資料包含:-<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>中傳回資料`sharedDataBlob`參數。</xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>      -根據索引鍵值，<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>中傳回資料`userDataBlob`參數。</xref:System.Web.UI.WebControls.WebParts.PersonalizationScope> 非`null`值`userName`參數會指示<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>也擷取資料。</xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>       <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>物件會自動更新<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>中的資料行`aspnet_Users`從頁面要求的內容中的資料庫載入每個時間特定使用者個人化資料的資料表。</xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A> </xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider> 此行為可讓其他的 ASP.NET 功能，可使用<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>屬性管理資料失效時記錄，以及決定站台上最近的使用者活動。</xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>"
  syntax:
    content: protected override void LoadPersonalizationBlobs (System.Web.UI.WebControls.WebParts.WebPartManager webPartManager, string path, string userName, ref byte[] sharedDataBlob, ref byte[] userDataBlob);
    parameters:
    - id: webPartManager
      type: System.Web.UI.WebControls.WebParts.WebPartManager
      description: "<xref href=&quot;System.Web.UI.WebControls.WebParts.WebPartManager&quot;> </xref>管理個人化資料。"
    - id: path
      type: System.String
      description: "路徑中的個人化資訊<xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationScope&quot;></xref>來當做擷取索引鍵的範圍內。"
    - id: userName
      type: System.String
      description: "中的個人化資訊的使用者名稱<xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationScope&quot;></xref>來當做擷取索引鍵的範圍內。"
    - id: sharedDataBlob
      type: System.Byte[]
      description: "傳回的資料，如<xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationScope&quot;></xref>範圍。"
    - id: userDataBlob
      type: System.Byte[]
      description: "傳回的資料，如<xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationScope&quot;></xref>範圍。"
  overload: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.LoadPersonalizationBlobs*
  exceptions: []
  platform:
  - net462
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetPersonalizationBlob(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String)
  id: ResetPersonalizationBlob(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String)
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  langs:
  - csharp
  name: ResetPersonalizationBlob(WebPartManager,String,String)
  nameWithType: SqlPersonalizationProvider.ResetPersonalizationBlob(WebPartManager,String,String)
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetPersonalizationBlob(WebPartManager,String,String)
  type: Method
  assemblies:
  - System.Web
  namespace: System.Web.UI.WebControls.WebParts
  summary: "從基礎資料存放區刪除個人化資料。"
  remarks: "<xref:System.Web.UI.WebControls.WebParts.WebPartPersonalization>若要從資料庫刪除個人化資料，當網站使用者選擇重設 Web 組件頁面上的資料，會使用這個方法。</xref:System.Web.UI.WebControls.WebParts.WebPartPersonalization> 如果`username`是非`null`，具有資料<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>領域資料已遭刪除; 否則資料與<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>領域刪除。</xref:System.Web.UI.WebControls.WebParts.PersonalizationScope> </xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>       <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>物件會自動更新<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>中的資料行`aspnet_Users`從頁面要求的內容中的資料庫刪除每個時間特定使用者個人化資料的資料表。</xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A> </xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider> 此行為可讓其他的 ASP.NET 功能，可使用<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>管理的過時資料記錄，以及決定站台上最近的使用者活動時的值。</xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>"
  syntax:
    content: protected override void ResetPersonalizationBlob (System.Web.UI.WebControls.WebParts.WebPartManager webPartManager, string path, string userName);
    parameters:
    - id: webPartManager
      type: System.Web.UI.WebControls.WebParts.WebPartManager
      description: "<xref href=&quot;System.Web.UI.WebControls.WebParts.WebPartManager&quot;> </xref>管理個人化資料。"
    - id: path
      type: System.String
      description: "路徑中的個人化資訊<xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationScope&quot;></xref>來當做擷取索引鍵的範圍內。"
    - id: userName
      type: System.String
      description: "中的個人化資訊的使用者名稱<xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationScope&quot;></xref>來當做擷取索引鍵的範圍內。"
  overload: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetPersonalizationBlob*
  exceptions: []
  platform:
  - net462
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.String[],System.String[])
  id: ResetState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.String[],System.String[])
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  langs:
  - csharp
  name: ResetState(PersonalizationScope,String[],String[])
  nameWithType: SqlPersonalizationProvider.ResetState(PersonalizationScope,String[],String[])
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetState(PersonalizationScope,String[],String[])
  type: Method
  assemblies:
  - System.Web
  namespace: System.Web.UI.WebControls.WebParts
  summary: "從基礎資料存放區，根據指定的參數，會刪除個人化狀態資訊。"
  remarks: "這個方法不支援任何萬用字元。       允許下列組合的參數:-`scope`參數設定，而所有其他參數會設定為`null`。 這個組合會刪除與所指定的個人化範圍相關聯的所有 Web 組件個人化資料`scope`。      -`scope`參數設定，而`paths`參數包含至少一個值。 這個組合會刪除指定的路徑或路徑中所指定的個人化範圍的所有 Web 組件個人化資料`scope`。      -`scope`參數設定為<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>、`paths`參數設定，而且包含只有一個路徑，而`usernames`參數包含至少一個值。</xref:System.Web.UI.WebControls.WebParts.PersonalizationScope> 這個組合會刪除所有的使用者個人化指定的路徑中包含的使用者與相關聯的 Web 組件資料`usernames`。      -`scope`參數設定為<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>、`paths`參數是`null`，而`usernames`參數包含至少一個值。</xref:System.Web.UI.WebControls.WebParts.PersonalizationScope> 這個組合會刪除所有的每位使用者個人化 Web 組件的資料，在與中所包含的使用者相關聯的所有路徑之間`usernames`。       參數值的任何其他組合無效，而且將會擲回<xref:System.ArgumentException>例外狀況。</xref:System.ArgumentException> 不允許下列兩個組合，例如:-`usernames`參數不能提供何時`scope`參數設定為<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>.</xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>      -`paths`參數不能包含多個項目時`usernames`參數不是`null`。       `paths`和`usernames`包含在個別的陣列參數必須符合下列的驗證規則。 如果失敗的任何驗證規則的參數陣列中，任何成員<xref:System.ArgumentException>擲回例外狀況。</xref:System.ArgumentException> 驗證規則包括:-`null`不允許的值。      為空字串 (&quot;&quot;) 不允許字串已修剪。      的中所包含任何使用者名稱`usernames`參數可以包含逗號。      -中的任何路徑的長度`paths`參數不能超過 256 個字元。      -在任何使用者名稱的長度`usernames`參數不能超過 256 個字元。"
  syntax:
    content: public override int ResetState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope, string[] paths, string[] usernames);
    parameters:
    - id: scope
      type: System.Web.UI.WebControls.WebParts.PersonalizationScope
      description: "A <xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationScope&quot;> </xref>指出要查詢的個人化資訊。 這個值不能<xref uid=&quot;langword_csharp_null&quot; name=&quot;null&quot; href=&quot;&quot;> </xref>。"
    - id: paths
      type: System.String[]
      description: "路徑中的個人化資訊<xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationScope&quot;></xref>要刪除的範圍。"
    - id: usernames
      type: System.String[]
      description: "中的個人化資訊的使用者名稱<xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationScope&quot;></xref>要刪除的範圍。"
    return:
      type: System.Int32
      description: "刪除資料列數目。"
  overload: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetState*
  exceptions:
  - type: System.ArgumentException
    commentId: T:System.ArgumentException
    description: "Either the <code>paths</code> or the <code>usernames</code> parameter is an empty array.  \n  \n \\- or -  \n  \n The <code>paths</code> and <code>usernames</code> parameters contained within the respective arrays do not meet the validation rules."
  - type: System.ArgumentOutOfRangeException
    commentId: T:System.ArgumentOutOfRangeException
    description: "<code>  scope </code>指定不是成員的<xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationScope&quot;></xref>列舉型別。"
  platform:
  - net462
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetUserState(System.String,System.DateTime)
  id: ResetUserState(System.String,System.DateTime)
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  langs:
  - csharp
  name: ResetUserState(String,DateTime)
  nameWithType: SqlPersonalizationProvider.ResetUserState(String,DateTime)
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetUserState(String,DateTime)
  type: Method
  assemblies:
  - System.Web
  namespace: System.Web.UI.WebControls.WebParts
  summary: "刪除使用者個人化資料從基礎資料存放區，根據指定的參數。"
  remarks: "這個方法的參數具有下列限制:-`path`參數不能包含萬用字元。      -如果`path`參數為非`null`，則每位使用者個人化記錄相關聯`path`將被刪除。      -只有每位使用者個人化資料錄會被視為非作用中指定的日期後的使用者相關聯`userInactiveSinceDate`參數將被刪除。 是精確的比較刪除記錄，其中<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>屬性小於或等於`userInactiveSinceDate`參數。</xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>      -如果未提供這兩個參數，則會刪除比對兩個條件約束的記錄。      -`path`參數可以是`null`。      -`path`參數不可為空字串修剪後。      -<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>屬性不可以是`null`。</xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>"
  syntax:
    content: public override int ResetUserState (string path, DateTime userInactiveSinceDate);
    parameters:
    - id: path
      type: System.String
      description: "要刪除個人化資料的路徑。 這個值可以是<xref uid=&quot;langword_csharp_null&quot; name=&quot;null&quot; href=&quot;&quot;></xref>但不能是空字串 (&quot;&quot;)。"
    - id: userInactiveSinceDate
      type: System.DateTime
      description: "指出上次活動日期。"
    return:
      type: System.Int32
      description: "從基礎資料存放區刪除的資料列計數。"
  overload: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetUserState*
  exceptions:
  - type: System.ArgumentException
    commentId: T:System.ArgumentException
    description: "<code>path</code> is an empty string.  \n  \n \\- or -  \n  \n The path is greater than 256 characters in length."
  platform:
  - net462
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.SavePersonalizationBlob(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String,System.Byte[])
  id: SavePersonalizationBlob(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String,System.Byte[])
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  langs:
  - csharp
  name: SavePersonalizationBlob(WebPartManager,String,String,Byte[])
  nameWithType: SqlPersonalizationProvider.SavePersonalizationBlob(WebPartManager,String,String,Byte[])
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.SavePersonalizationBlob(WebPartManager,String,String,Byte[])
  type: Method
  assemblies:
  - System.Web
  namespace: System.Web.UI.WebControls.WebParts
  summary: "將未經處理的個人化資料儲存至基礎的 Microsoft SQL Server 資料庫。"
  remarks: "如果將非`null`提供使用者名稱，然後在`dataBlob`參數會包含個人化資料<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>範圍; 否則`dataBlob`假設為包含資料<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>範圍。</xref:System.Web.UI.WebControls.WebParts.PersonalizationScope> </xref:System.Web.UI.WebControls.WebParts.PersonalizationScope>       <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>物件會自動更新<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>中的資料行`aspnet_Users`資料表每個時間特定使用者個人化資料儲存至頁面要求的內容中的資料庫。</xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A> </xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider> 此行為可讓其他的 ASP.NET 功能，可使用<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>屬性管理資料失效時記錄，以及決定站台上最近的使用者活動。</xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>"
  syntax:
    content: protected override void SavePersonalizationBlob (System.Web.UI.WebControls.WebParts.WebPartManager webPartManager, string path, string userName, byte[] dataBlob);
    parameters:
    - id: webPartManager
      type: System.Web.UI.WebControls.WebParts.WebPartManager
      description: "<xref href=&quot;System.Web.UI.WebControls.WebParts.WebPartManager&quot;> </xref>管理個人化資料。"
    - id: path
      type: System.String
      description: "A <xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationScope&quot;> </xref>指出要儲存個人化資訊。 這個值不能<xref uid=&quot;langword_csharp_null&quot; name=&quot;null&quot; href=&quot;&quot;> </xref>。"
    - id: userName
      type: System.String
      description: "中的個人化資訊的使用者名稱<xref href=&quot;System.Web.UI.WebControls.WebParts.PersonalizationScope&quot;></xref>来做為索引鍵的範圍。"
    - id: dataBlob
      type: System.Byte[]
      description: "要儲存資料的位元組陣列。"
  overload: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.SavePersonalizationBlob*
  exceptions: []
  platform:
  - net462
references:
- uid: System.Web.UI.WebControls.WebParts.PersonalizationProvider
  isExternal: false
  name: System.Web.UI.WebControls.WebParts.PersonalizationProvider
- uid: System.Configuration.Provider.ProviderException
  parent: System.Configuration.Provider
  isExternal: false
  name: ProviderException
  nameWithType: ProviderException
  fullName: System.Configuration.Provider.ProviderException
- uid: System.ArgumentException
  isExternal: true
  name: System.ArgumentException
- uid: System.ArgumentOutOfRangeException
  isExternal: true
  name: System.ArgumentOutOfRangeException
- uid: System.ArgumentNullException
  isExternal: true
  name: System.ArgumentNullException
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.#ctor
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: SqlPersonalizationProvider()
  nameWithType: SqlPersonalizationProvider.SqlPersonalizationProvider()
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.SqlPersonalizationProvider()
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: ApplicationName
  nameWithType: SqlPersonalizationProvider.ApplicationName
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName
- uid: System.String
  parent: System
  isExternal: true
  name: String
  nameWithType: String
  fullName: System.String
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.FindState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.Web.UI.WebControls.WebParts.PersonalizationStateQuery,System.Int32,System.Int32,System.Int32@)
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: FindState(PersonalizationScope,PersonalizationStateQuery,Int32,Int32,Int32)
  nameWithType: SqlPersonalizationProvider.FindState(PersonalizationScope,PersonalizationStateQuery,Int32,Int32,Int32)
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.FindState(PersonalizationScope,PersonalizationStateQuery,Int32,Int32,Int32)
- uid: System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection
  parent: System.Web.UI.WebControls.WebParts
  isExternal: false
  name: PersonalizationStateInfoCollection
  nameWithType: PersonalizationStateInfoCollection
  fullName: System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection
- uid: System.Web.UI.WebControls.WebParts.PersonalizationScope
  parent: System.Web.UI.WebControls.WebParts
  isExternal: false
  name: PersonalizationScope
  nameWithType: PersonalizationScope
  fullName: System.Web.UI.WebControls.WebParts.PersonalizationScope
- uid: System.Web.UI.WebControls.WebParts.PersonalizationStateQuery
  parent: System.Web.UI.WebControls.WebParts
  isExternal: false
  name: PersonalizationStateQuery
  nameWithType: PersonalizationStateQuery
  fullName: System.Web.UI.WebControls.WebParts.PersonalizationStateQuery
- uid: System.Int32
  parent: System
  isExternal: true
  name: Int32
  nameWithType: Int32
  fullName: System.Int32
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.GetCountOfState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.Web.UI.WebControls.WebParts.PersonalizationStateQuery)
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: GetCountOfState(PersonalizationScope,PersonalizationStateQuery)
  nameWithType: SqlPersonalizationProvider.GetCountOfState(PersonalizationScope,PersonalizationStateQuery)
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.GetCountOfState(PersonalizationScope,PersonalizationStateQuery)
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.Initialize(System.String,System.Collections.Specialized.NameValueCollection)
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: Initialize(String,NameValueCollection)
  nameWithType: SqlPersonalizationProvider.Initialize(String,NameValueCollection)
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.Initialize(String,NameValueCollection)
- uid: System.Collections.Specialized.NameValueCollection
  parent: System.Collections.Specialized
  isExternal: false
  name: NameValueCollection
  nameWithType: NameValueCollection
  fullName: System.Collections.Specialized.NameValueCollection
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.LoadPersonalizationBlobs(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String,System.Byte[]@,System.Byte[]@)
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: LoadPersonalizationBlobs(WebPartManager,String,String,Byte[],Byte[])
  nameWithType: SqlPersonalizationProvider.LoadPersonalizationBlobs(WebPartManager,String,String,Byte[],Byte[])
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.LoadPersonalizationBlobs(WebPartManager,String,String,Byte[],Byte[])
- uid: System.Web.UI.WebControls.WebParts.WebPartManager
  parent: System.Web.UI.WebControls.WebParts
  isExternal: false
  name: WebPartManager
  nameWithType: WebPartManager
  fullName: System.Web.UI.WebControls.WebParts.WebPartManager
- uid: System.Byte[]
  parent: System
  isExternal: true
  name: Byte
  nameWithType: Byte
  fullName: System.Byte[]
  spec.csharp:
  - uid: System.Byte
    name: Byte
    nameWithType: Byte
    fullName: Byte[]
  - name: '[]'
    nameWithType: '[]'
    fullName: '[]'
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetPersonalizationBlob(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String)
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: ResetPersonalizationBlob(WebPartManager,String,String)
  nameWithType: SqlPersonalizationProvider.ResetPersonalizationBlob(WebPartManager,String,String)
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetPersonalizationBlob(WebPartManager,String,String)
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.String[],System.String[])
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: ResetState(PersonalizationScope,String[],String[])
  nameWithType: SqlPersonalizationProvider.ResetState(PersonalizationScope,String[],String[])
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetState(PersonalizationScope,String[],String[])
- uid: System.String[]
  parent: System
  isExternal: true
  name: String
  nameWithType: String
  fullName: System.String[]
  spec.csharp:
  - uid: System.String
    name: String
    nameWithType: String
    fullName: String[]
  - name: '[]'
    nameWithType: '[]'
    fullName: '[]'
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetUserState(System.String,System.DateTime)
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: ResetUserState(String,DateTime)
  nameWithType: SqlPersonalizationProvider.ResetUserState(String,DateTime)
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetUserState(String,DateTime)
- uid: System.DateTime
  parent: System
  isExternal: true
  name: DateTime
  nameWithType: DateTime
  fullName: System.DateTime
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.SavePersonalizationBlob(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String,System.Byte[])
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: SavePersonalizationBlob(WebPartManager,String,String,Byte[])
  nameWithType: SqlPersonalizationProvider.SavePersonalizationBlob(WebPartManager,String,String,Byte[])
  fullName: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.SavePersonalizationBlob(WebPartManager,String,String,Byte[])
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.#ctor*
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: SqlPersonalizationProvider
  nameWithType: SqlPersonalizationProvider.SqlPersonalizationProvider
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName*
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: ApplicationName
  nameWithType: SqlPersonalizationProvider.ApplicationName
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.FindState*
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: FindState
  nameWithType: SqlPersonalizationProvider.FindState
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.GetCountOfState*
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: GetCountOfState
  nameWithType: SqlPersonalizationProvider.GetCountOfState
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.Initialize*
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: Initialize
  nameWithType: SqlPersonalizationProvider.Initialize
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.LoadPersonalizationBlobs*
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: LoadPersonalizationBlobs
  nameWithType: SqlPersonalizationProvider.LoadPersonalizationBlobs
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetPersonalizationBlob*
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: ResetPersonalizationBlob
  nameWithType: SqlPersonalizationProvider.ResetPersonalizationBlob
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetState*
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: ResetState
  nameWithType: SqlPersonalizationProvider.ResetState
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetUserState*
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: ResetUserState
  nameWithType: SqlPersonalizationProvider.ResetUserState
- uid: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.SavePersonalizationBlob*
  parent: System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider
  isExternal: false
  name: SavePersonalizationBlob
  nameWithType: SqlPersonalizationProvider.SavePersonalizationBlob
